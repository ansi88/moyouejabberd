{aa_inf_server, 'aa_inf@s3'}.

{log_node, 'log@s3'}.

{ram_msg_bak_nodes, [ejabberd@aliyun_test2]}.

{store_user_tables_info, 1}.

{store_group_members, 1}.

{host_config, "gamepro.com",    [ {http_server, "http://221.122.114.216/gamepro"}  , {http_server_service_client,"/xmppcallback"}, {ack_from,true},{auth,false}]}.

{host_config, "push.gamepro.com",[ {http_server, "http://221.122.114.216/gamepro"}  , {http_server_service_client,"/xmppcallback"}, {ack_from,true} ]}.

{host_config, "lolverifier.com",[{ack_from,true},{auth, false}]}.

{mysql_config,  [
                    {my_db_conn, [
                                {host, "momotalk.mysql.rds.aliyuncs.com"},
                                {port, 3306},
                                {user, "xmpptest"},
                                {password, "momotalk"},
                                {database, "messages"},
                                {encode, utf8},
                                {poolsize, 70}
                    ]}
                ]}.
%%
%% loglevel: Verbosity of log files generated by ejabberd.
%% 0: No ejabberd log at all (not recommended)
%% 1: Critical
%% 2: Error
%% 3: Warning
%% 4: Info
%% 5: Debug
%%
{loglevel, 5}.

{hosts, [
        "gamepro.com",
        "group.gamepro.com",
        "push.gamepro.com",
        "lolverifier.com"
]}.

{listen,
 [

  {5222, ejabberd_c2s, [
                        {certfile, "/opt/ejabberd/etc/ejabberd/server.pem"},
                        starttls,
                        {access, c2s},
                        {shaper, c2s_shaper},
                        {max_stanza_size, 65536}
                       ]},

  {5269, ejabberd_s2s_in, [
                           {shaper, s2s_shaper},
                           {max_stanza_size, 131072}
                          ]},

  {5280, ejabberd_http, [
                         {request_handlers, [
                               {["web"], mod_http_fileserver},
                               {["rest"], mod_rest}
                         ]},
                         http_bind,
                         http_poll,
                         web_admin
                        ]}

 ]}.

{s2s_certfile, "/etc/ejabberd/server.pem"}.

{auth_method, external}.

{shaper, normal, {maxrate, 3000000}}.

{shaper, fast, {maxrate, 5000000}}.

{max_fsm_queue, 100000}.

{acl, local, {user_regexp, ""}}.

{access, max_user_sessions, [{5, all}]}.

{access, local, [{allow, local}]}.

{access, c2s, [{deny, blocked}, {allow, all}]}.

{access, c2s_shaper, [{none, admin}, {normal, all}]}.

{access, s2s_shaper, [{fast, all}]}.

{access, announce, [{allow, admin}]}.

{access, configure, [{allow, admin}]}.

{access, muc_admin, [{allow, admin}]}.

{access, muc_create, [{allow, all}]}.

{access, muc, [{allow, all}]}.

{access, register, [{allow, all}]}.

{registration_timeout, infinity}.

{language, "en"}.

{modules,
 [
  {mod_adhoc,    []},
  {mod_announce, [{access, announce}]}, % recommends mod_adhoc
  {mod_blocking,[]}, % requires mod_privacy
  {mod_caps,     []},
  {mod_configure,[]}, % requires mod_adhoc
  {mod_disco,    []},
  %%{mod_echo,   [{host, "echo.localhost"}]},
  {mod_http_bind, []},
%%  {mod_last,     []},
  {mod_ping,     []},
  %%{mod_pres_counter,[{count, 5}, {interval, 60}]},
  {mod_privacy,  []},
  {mod_private,  []},
  %%{mod_proxy65,[]},
  {mod_register, []},
  {mod_roster,   []},
  %%{mod_service_log,[]},
  {mod_shared_roster,[]},
  {mod_stats,    []},
  {mod_time,     []},
  {mod_vcard,    []},
  {mod_version,  []},
  {mod_rest, [
                 {allowed_ips, "all"},
                 {allowed_stanza_types, [ "message", "presence", "iq" ]},
                 {access_commands, [ {configure, [registered_users], []} ]} ]}
 ]}.